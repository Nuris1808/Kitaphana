from flask import Flask, render_template, request, jsonify

app = Flask(_name_)

# –ö—ñ—Ç–∞–ø—Ç–∞—Ä–¥—ã“£ –±–∞—Å—Ç–∞–ø“õ—ã —Ç—ñ–∑—ñ–º—ñ
books = {
    "“í—ã–ª—ã–º": [
        {"title": "–§–∏–∑–∏–∫–∞ –Ω–µ–≥—ñ–∑–¥–µ—Ä—ñ", "status": "–ë–∞—Ä", "borrowed_by": ""},
        {"title": "–•–∏–º–∏—è–Ω—ã“£ “õ“±–ø–∏—è–ª–∞—Ä—ã", "status": "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ", "borrowed_by": "–ê–π–¥–æ—Å"}
    ],
    "”ò–¥–µ–±–∏–µ—Ç": [
        {"title": "–ê–±–∞–π –∂–æ–ª—ã", "status": "–ë–∞—Ä", "borrowed_by": ""},
        {"title": "–ö”©—à–ø–µ–Ω–¥—ñ–ª–µ—Ä", "status": "–ñ–æ“õ", "borrowed_by": ""}
    ],
    "–¢–∞—Ä–∏—Ö": [
        {"title": "“ö–∞–∑–∞“õ —Ö–∞–Ω–¥—ã“ì—ã", "status": "–ë–∞—Ä", "borrowed_by": ""},
        {"title": "–ï–∂–µ–ª–≥—ñ ”©—Ä–∫–µ–Ω–∏–µ—Ç—Ç–µ—Ä", "status": "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ", "borrowed_by": "–î–∏–∞—Å"}
    ],
    "–¢–µ—Ö–Ω–∏–∫–∞": [
        {"title": "–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É –Ω–µ–≥—ñ–∑–¥–µ—Ä—ñ", "status": "–ñ–æ“õ", "borrowed_by": ""},
        {"title": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "status": "–ë–∞—Ä", "borrowed_by": ""}
    ]
}

# –ë–∞—Å—Ç—ã –±–µ—Ç
@app.route('/')
def index():
    return render_template("index.html", books=books)

# –ö—ñ—Ç–∞–ø—Ç—ã“£ —Å—Ç–∞—Ç—É—Å—ã–Ω ”©–∑–≥–µ—Ä—Ç—É
@app.route('/update_status', methods=['

–ï–≥–µ—Ä *—Ç–µ–∫ HTML, CSS, –∂”ô–Ω–µ JavaScript* –∞—Ä“õ—ã–ª—ã –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞–Ω—ã –±–∞—Å“õ–∞—Ä—É –∫–µ—Ä–µ–∫ –±–æ–ª—Å–∞, –æ–Ω–¥–∞ –±–∞—Ä–ª—ã“õ —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä–¥—ã *JavaScript* –∞—Ä“õ—ã–ª—ã –∂–∞—Å–∞–π–º—ã–∑. –ë“±–ª —Å–∞–π—Ç *—Å–µ—Ä–≤–µ—Ä—Å—ñ–∑, —Ç–µ–∫ –±—Ä–∞—É–∑–µ—Ä–¥–µ –∂“±–º—ã—Å —ñ—Å—Ç–µ–π–¥—ñ*.  

---

## *üìå –§—É–Ω–∫—Ü–∏—è–ª–∞—Ä—ã:*  
‚úÖ *–ö—ñ—Ç–∞–ø—Ç–∞—Ä–¥—ã –∫”©—Ä—É*  
‚úÖ *–ö—ñ—Ç–∞–ø—Ç—ã —ñ–∑–¥–µ—É*  
‚úÖ *–°—Ç–∞—Ç—É—Å—Ç—ã ”©–∑–≥–µ—Ä—Ç—É* ("–ë–∞—Ä" ‚Üí "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ (–∞–¥–∞–º)" ‚Üí "–ñ–æ“õ")  
‚úÖ *–ê–¥–∞–º–Ω—ã“£ –∞—Ç—ã–Ω –µ–Ω–≥—ñ–∑—É*  
‚úÖ *–ë–∞—Ä–ª—ã“õ –¥–µ—Ä–µ–∫ –∂–µ—Ä–≥—ñ–ª—ñ–∫—Ç—ñ –∂–∞–¥—Ç–∞ —Å–∞“õ—Ç–∞–ª–∞–¥—ã (localStorage)*  

---

### *üåç –ö–æ–¥ (HTML + CSS + JavaScript)*
–ë“±–ª –∫–æ–¥—Ç—ã *index.html* —Ñ–∞–π–ª—ã–Ω–∞ —Å–∞“õ—Ç–∞–ø, —Ç—ñ–∫–µ–ª–µ–π —à–æ–ª“ì—ã—à—Ç–∞ –∞—à—Å–∞“£ –∂–µ—Ç–∫—ñ–ª—ñ–∫—Ç—ñ.  

```html
<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—ñ—Ç–∞–ø—Ö–∞–Ω–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: white;
            padding: 15px;
            text-align: center;
        }
        main {
            padding: 20px;
        }
        .search-box {
            margin-bottom: 15px;
            padding: 10px;
            width: 100%;
            max-width: 400px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .category {
            background-color: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
        }
        .book-list {
            list-style: none;
            padding: 0;
        }
        .book-list li {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
        }
        .available { color: green; }
        .not-available { color: red; }
        .borrowed { color: orange; }
        button {
            cursor: pointer;
            padding: 5px 10px;
            margin-left: 10px;
        }
    </style>
</head>
<body>

<header>
    <h1>üìö –ö—ñ—Ç–∞–ø—Ö–∞–Ω–∞</h1>
</header>

<main>
    <input type="text" class="search-box" placeholder="üîé –ö—ñ—Ç–∞–ø—Ç—ã —ñ–∑–¥–µ—É..." oninput="searchBooks()">
    <div id="library"></div>
</main>

<script>
    let books = JSON.parse(localStorage.getItem("books")) || {
        "“í—ã–ª—ã–º": [
            { title: "–§–∏–∑–∏–∫–∞ –Ω–µ–≥—ñ–∑–¥–µ—Ä—ñ", status: "–ë–∞—Ä", borrowedBy: "" },
            { title: "–•–∏–º–∏—è–Ω—ã“£ “õ“±–ø–∏—è–ª–∞—Ä—ã", status: "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ", borrowedBy: "–ê–π–¥–æ—Å" }
        ],
        "”ò–¥–µ–±–∏–µ—Ç": [
            { title: "–ê–±–∞–π –∂–æ–ª—ã", status: "–ë–∞—Ä", borrowedBy: "" },
            { title: "–ö”©—à–ø–µ–Ω–¥—ñ–ª–µ—Ä", status: "–ñ–æ“õ", borrowedBy: "" }
        ],
        "–¢–∞—Ä–∏—Ö": [
            { title: "“ö–∞–∑–∞“õ —Ö–∞–Ω–¥—ã“ì—ã", status: "–ë–∞—Ä", borrowedBy: "" },
            { title: "–ï–∂–µ–ª–≥—ñ ”©—Ä–∫–µ–Ω–∏–µ—Ç—Ç–µ—Ä", status: "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ", borrowedBy: "–î–∏–∞—Å" }
        ],
        "–¢–µ—Ö–Ω–∏–∫–∞": [
            { title: "–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—É –Ω–µ–≥—ñ–∑–¥–µ—Ä—ñ", status: "–ñ–æ“õ", borrowedBy: "" },
            { title: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", status: "–ë–∞—Ä", borrowedBy: "" }
        ]
    };

    function saveBooks() {
        localStorage.setItem("books", JSON.stringify(books));
    }

    function updateLibrary() {
        const libraryDiv = document.getElementById("library");
        libraryDiv.innerHTML = "";

        for (const category in books) {
            const section = document.createElement("div");
            section.classList.add("category");
            section.innerHTML = <h2>${category}</h2><ul class="book-list"></ul>;

            const bookList = section.querySelector(".book-list");

            books[category].forEach((book, index) => {
                const listItem = document.createElement("li");

                let statusClass = "";
                if (book.status === "–ë–∞—Ä") statusClass = "available";
                else if (book.status === "–ñ–æ“õ") statusClass = "not-available";
                else if (book.status === "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ") statusClass = "borrowed";

                let statusText = book.status;
                if (book.status === "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ" && book.borrowedBy) {
                    statusText += ` (${book.borrowedBy})`;
                }

                listItem.innerHTML = `
                    <span>${book.title}</span>
                    <span class="status ${statusClass}">${statusText}</span>
                    <button onclick="toggleStatus('${category}', ${index})">üîÑ ”®–∑–≥–µ—Ä—Ç—É</button>
                `;
                bookList.appendChild(listItem);
            });

            libraryDiv.appendChild(section);
        }
    }

    function toggleStatus(category, index) {
        const statuses = ["–ë–∞—Ä", "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ", "–ñ–æ“õ"];
        const book = books[category][index];

        let currentIndex = statuses.indexOf(book.status);
        let newStatus = statuses[(currentIndex + 1) % statuses.length];

        if (newStatus === "–ê–ª—ã–ø –∫–µ—Ç—Ç—ñ") {
            let borrower = prompt("üìå –ö—ñ—Ç–∞–ø—Ç—ã –∞–ª“ì–∞–Ω –∞–¥–∞–º–Ω—ã“£ –∞—Ç—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:");
            if (!borrower) {
                return;
            }
            book.borrowedBy = borrower;
        } else {
            book.borrowedBy = "";
        }

        book.status = newStatus;
        saveBooks();
        updateLibrary();
    }

    function searchBooks() {
        const query = document.querySelector(".search-box").value.toLowerCase();
        document.querySelectorAll(".book-list li").forEach(item => {
            const title = item.querySelector("span").textContent.toLowerCase();
            item.style.display = title.includes(query) ? "" : "none";
        });
    }

    updateLibrary();
</script>

</body>
</html>
